<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="API Reference" href="api.html" /><link rel="prev" title="Large langauage model experimentation." href="top.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Inferencing and Training Large Language Model Tasks - Large langauage model experimentation. 0.1.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="top.html"><div class="brand">Large langauage model experimentation. 0.1.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="top.html">
  
  
  <span class="sidebar-brand-text">Large langauage model experimentation. 0.1.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="api.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="api/zensols.lmtask.html">zensols.lmtask package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributing</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/index.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="inferencing-and-training-large-language-model-tasks">
<h1>Inferencing and Training Large Language Model Tasks<a class="headerlink" href="#inferencing-and-training-large-language-model-tasks" title="Link to this heading">¶</a></h1>
<p><a class="reference external" href="https://pypi.python.org/pypi/zensols.lmtask"><img alt="PyPI" src="https://img.shields.io/pypi/v/zensols.lmtask.svg" /></a>
<a class="reference external" href="https://www.python.org/downloads/release/python-3110"><img alt="Python 3.11" src="https://img.shields.io/badge/python-3.11-blue.svg" /></a>
<a class="reference external" href="https://www.python.org/downloads/release/python-3120"><img alt="Python 3.12" src="https://img.shields.io/badge/python-3.12-blue.svg" /></a></p>
<p>A large language model (LLM) API to train and inference specifically for tasks.
The API provides utility classes and configuration to streamline project’s
access to LLM responses that (can be) machine readable, such as querying the
LLM to produce JSON output–even if that output is partial given output token
limits.  The package provides an API to train and interface with LLMs as both
pretrained embeddings and instruct models.</p>
<p>Features:</p>
<ul class="simple">
<li><p>Create new LLMs with configuration without having to write code.</p></li>
<li><p><a class="reference external" href="resources/tasks.yml">Three examples</a> of “code-less” models: sentiment
analysis, NER tagging and generation.</p></li>
<li><p>Cache LLM responses to save from recomputing potentially costly prompts
(optional feature).</p></li>
<li><p><a class="reference external" href="#command-line">Command-line</a> interface to inference, pre-train and
post-train LLM models.</p></li>
<li><p><a class="reference external" href="#python-api">Advanced API</a> to read responses and accept partial output for
max token cutoffs.</p></li>
<li><p>Chat template integration when supported.</p></li>
<li><p>Extendable interfaces with LLMs with built in support for Llama 3.</p></li>
<li><p><a class="reference external" href="#datasets">Easy to configure datasets</a> processed by model trainers</p></li>
</ul>
<section id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Link to this heading">¶</a></h2>
<p>See the <a class="reference external" href="https://plandes.github.io/lmtask/index.html">full documentation</a>.
The <a class="reference external" href="https://plandes.github.io/lmtask/api.html">API reference</a> is also
available.</p>
</section>
<section id="obtaining">
<h2>Obtaining<a class="headerlink" href="#obtaining" title="Link to this heading">¶</a></h2>
<p>The library can be installed with pip from the <a class="reference external" href="https://pypi.org/project/zensols.lmtask/">pypi</a> repository:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip3<span class="w"> </span>install<span class="w"> </span>zensols.lmtask
</pre></div>
</div>
<p>A Conda environment can also be created with the
<a class="reference external" href="src/python/environment.yml">environment.yml</a>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>src/python/environment.yml
</pre></div>
</div>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p>The package can be used from the command line to both inference and train a new
model or as an API.</p>
<section id="command-line">
<h3>Command Line<a class="headerlink" href="#command-line" title="Link to this heading">¶</a></h3>
<p>The command-line can be used for inferencing to list available tasks:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lmtask<span class="w"> </span>task
</pre></div>
</div>
<p>Generate text by inferencing using the Llama base model:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lmtask<span class="w"> </span>stream<span class="w"> </span>base_generate<span class="w"> </span><span class="s1">&#39;in a world long long away&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--override<span class="o">=</span>lmtask_model_generate_args.temperature<span class="o">=</span><span class="m">0</span>.9
</pre></div>
</div>
<p>Use named entity recognition (NER):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lmtask<span class="w"> </span>instruct<span class="w"> </span>ner<span class="w"> </span><span class="s1">&#39;UIC is in Chicago.&#39;</span><span class="w"> </span>
model_output_json:
<span class="w">    </span>label:<span class="w"> </span>ORG
<span class="w">    </span>span:<span class="w"> </span><span class="o">[</span><span class="m">0</span>,<span class="w"> </span><span class="m">3</span><span class="o">]</span>
<span class="w">    </span>text:<span class="w"> </span>UIC
<span class="w">    </span>label:<span class="w"> </span>O
<span class="w">    </span>span:<span class="w"> </span><span class="o">[</span><span class="m">4</span>,<span class="w"> </span><span class="m">6</span><span class="o">]</span>
<span class="w">    </span>text:<span class="w"> </span>is
<span class="w">    </span>label:<span class="w"> </span>O
<span class="w">    </span>span:<span class="w"> </span><span class="o">[</span><span class="m">7</span>,<span class="w"> </span><span class="m">9</span><span class="o">]</span>
<span class="w">    </span>text:<span class="w"> </span><span class="k">in</span>
<span class="w">    </span>label:<span class="w"> </span>LOC
<span class="w">    </span>span:<span class="w"> </span><span class="o">[</span><span class="m">10</span>,<span class="w"> </span><span class="m">15</span><span class="o">]</span>
<span class="w">    </span>text:<span class="w"> </span>Chicago
</pre></div>
</div>
<p>The command-line program can be used to train new models with just
configuration.  See the <a class="reference external" href="trainconf">trainconf</a> directory for examples of
configuration file.  Before you train, you might want to get a sample of the
configured dataset:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lmtask<span class="w"> </span>-c<span class="w"> </span>trainconf/imdb.yml<span class="w"> </span>sample<span class="w"> </span>-m<span class="w"> </span><span class="m">1</span>
________________________________________
&lt;<span class="p">|</span>begin_of_text<span class="p">|</span>&gt;&lt;<span class="p">|</span>start_header_id<span class="p">|</span>&gt;system&lt;<span class="p">|</span>end_header_id<span class="p">|</span>&gt;

Cutting<span class="w"> </span>Knowledge<span class="w"> </span>Date:<span class="w"> </span>December<span class="w"> </span><span class="m">2023</span>
Today<span class="w"> </span>Date:<span class="w"> </span><span class="m">26</span><span class="w"> </span>Jul<span class="w"> </span><span class="m">2024</span>

You<span class="w"> </span>are<span class="w"> </span>a<span class="w"> </span>sentiment<span class="w"> </span>classifier.&lt;<span class="p">|</span>eot_id<span class="p">|</span>&gt;&lt;<span class="p">|</span>start_header_id<span class="p">|</span>&gt;user&lt;<span class="p">|</span>end_header_id<span class="p">|</span>&gt;

Only<span class="w"> </span>output<span class="w"> </span>the<span class="w"> </span>sentiment.

<span class="c1">### Review:We always watch American movies with their particular...</span>
<span class="c1">### Sentiment:```positive```&lt;|eot_id|&gt;</span>
</pre></div>
</div>
<p>To train a new sentiment model on the IMDB dataset:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lmtask<span class="w"> </span>-c<span class="w"> </span>trainconf/imdb.yml<span class="w"> </span>train
</pre></div>
</div>
</section>
<section id="python-api">
<h3>Python API<a class="headerlink" href="#python-api" title="Link to this heading">¶</a></h3>
<p>The Python API can be used to access tasks directly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">zensols.lmtask</span><span class="w"> </span><span class="kn">import</span> <span class="n">ApplicationFactory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">zensols.lmtask</span><span class="w"> </span><span class="kn">import</span> <span class="n">InstructTaskRequest</span>

<span class="go"># create the task factory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fac</span> <span class="o">=</span> <span class="n">ApplicationFactory</span><span class="o">.</span><span class="n">get_task_factory</span><span class="p">()</span>

<span class="go"># list configured tasks</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fac</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">short</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">base_generate (base generate text)</span>
<span class="go">instruct_generate (base generate text)</span>
<span class="go">ner (tags named entities)</span>
<span class="go">sentiment (classifies sentiment)</span>

<span class="go"># create a sentiment analysis task</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">task</span> <span class="o">=</span> <span class="n">fac</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s1">&#39;sentiment&#39;</span><span class="p">)</span>

<span class="go"># inference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sents</span> <span class="o">=</span> <span class="s1">&#39;I love football.</span><span class="se">\n</span><span class="s1">I hate olives.</span><span class="se">\n</span><span class="s1">Earth is big.&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">InstructTaskRequest</span><span class="p">(</span><span class="n">instruction</span><span class="o">=</span><span class="n">sents</span><span class="p">))</span>

<span class="go"># print the JSON result as formatted text</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">model_output_json</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
<span class="go">[</span>
<span class="go">    {</span>
<span class="go">        &quot;index&quot;: 0,</span>
<span class="go">        &quot;sentence&quot;: &quot;I love football.&quot;,</span>
<span class="go">        &quot;label&quot;: &quot;+&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">        &quot;index&quot;: 1,</span>
<span class="go">        &quot;sentence&quot;: &quot;I hate olives.&quot;,</span>
<span class="go">        &quot;label&quot;: &quot;-&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">        &quot;index&quot;: 2,</span>
<span class="go">        &quot;sentence&quot;: &quot;Earth is big.&quot;,</span>
<span class="go">        &quot;label&quot;: &quot;n&quot;</span>
<span class="go">    }</span>
<span class="go">]</span>
</pre></div>
</div>
</section>
</section>
<section id="datasets">
<h2>Datasets<a class="headerlink" href="#datasets" title="Link to this heading">¶</a></h2>
<p>The package features easy to configure datasets and data processing on it.  For
example, the following is taken from the <a class="reference external" href="trainconf/imdb.yml">IMDB training
configuration</a> example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># a dataset factory instance used by the trainer (lmtask_trainer_hf)</span>
<span class="nt">lmtask_imdb_source</span><span class="p">:</span>
<span class="w">  </span><span class="nt">class_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zensols.lmtask.dataset.LoadedTaskDatasetFactory</span>
<span class="w">  </span><span class="c1"># the dataset name (downloaded if not already); this can be a `pathlib.Path`,</span>
<span class="w">  </span><span class="c1"># Pandas dataframe or Zensols Stash</span>
<span class="w">  </span><span class="nt">source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stanfordnlp/imdb</span>
<span class="w">  </span><span class="c1"># use only the training split</span>
<span class="w">  </span><span class="nt">load_args</span><span class="p">:</span>
<span class="w">    </span><span class="nt">split</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">train</span>
<span class="w">  </span><span class="c1"># the task that consumes the data, which will format each datapoint</span>
<span class="w">  </span><span class="c1"># specifically for that task&#39;s model</span>
<span class="w">  </span><span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;instance:</span><span class="nv"> </span><span class="s">lmtask_task_imdb&#39;</span>
<span class="w">  </span><span class="c1"># preprocessing Python source code to add labels and subset the data (db.select)</span>
<span class="w">  </span><span class="nt">pre_process</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|-</span>
<span class="w">    </span><span class="no">ds = ds.map(lambda x: {&#39;output&#39;: &#39;positive&#39; if x[&#39;label&#39;] == 1 else &#39;negative&#39;})</span>
<span class="w">    </span><span class="no">ds = ds.rename_column(&#39;text&#39;, &#39;instruction&#39;)</span>
<span class="w">    </span><span class="no">ds = ds.shuffle(seed=0)</span>
<span class="w">    </span><span class="no"># 7K takes 55m</span>
<span class="w">    </span><span class="no">ds = ds.select(range(7_000))</span>
</pre></div>
</div>
</section>
<section id="changelog">
<h2>Changelog<a class="headerlink" href="#changelog" title="Link to this heading">¶</a></h2>
<p>An extensive changelog is available <a class="reference internal" href="CHANGELOG.html"><span class="doc">here</span></a>.</p>
</section>
<section id="community">
<h2>Community<a class="headerlink" href="#community" title="Link to this heading">¶</a></h2>
<p>Please star this repository and let me know how and where you use this API.
Contributions as pull requests, feedback and any input is welcome.</p>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Link to this heading">¶</a></h2>
<p><a class="reference internal" href="LICENSE.html"><span class="doc">MIT License</span></a></p>
<p>Copyright (c) 2025 Paul Landes</p>
<!-- links --></section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="api.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">API Reference</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="top.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025 Paul Landes
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Inferencing and Training Large Language Model Tasks</a><ul>
<li><a class="reference internal" href="#documentation">Documentation</a></li>
<li><a class="reference internal" href="#obtaining">Obtaining</a></li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#command-line">Command Line</a></li>
<li><a class="reference internal" href="#python-api">Python API</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datasets">Datasets</a></li>
<li><a class="reference internal" href="#changelog">Changelog</a></li>
<li><a class="reference internal" href="#community">Community</a></li>
<li><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=a58bc63e"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    </body>
</html>